---
import Layout from '../layouts/Layout.astro';
import Stats from '../components/Icons/Stats.astro';
import Tunder from '../components/Icons/Tunder.astro';

const stats = [
  { value: '98%', label: 'Mejora en Core Web Vitals', icon: 'Zap' },
  { value: '3x', label: 'En Conversiones', icon: 'TrendingUp' },
  { value: '<1s', label: 'Tiempo de Carga', icon: 'Clock' },
  { value: '50+', label: 'Proyectos Entregados', icon: 'Globe' },
];

const technologies = [
  'Astro', 'React', 'n8n', 'TypeScript', 'Node.js', 'PostgreSQL', 
  'Tailwind CSS', 'Framer Motion', 'Three.js', 'Supabase', 'Vercel',
  'OpenAI', 'Stripe', 'AWS', 'Cloudflare', 'API Integrations'
];

const caseStudies = [
  {
    client: 'TechStart MX',
    industry: 'SaaS',
    results: [
      { metric: 'Conversiones', before: '2.1%', after: '8.7%' },
      { metric: 'Velocidad', before: '4.2s', after: '0.8s' },
      { metric: 'SEO Ranking', before: '#47', after: '#3' },
    ],
  },
  {
    client: 'EcoVerde Store',
    industry: 'E-commerce',
    results: [
      { metric: 'Ventas', before: '$15k/mes', after: '$58k/mes' },
      { metric: 'Bounce Rate', before: '72%', after: '34%' },
      { metric: 'Sesiones', before: '5k', after: '28k' },
    ],
  },
];

// Datos estructurados para IA (AEO)
const schemaData = {
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "headline": "Ingeniería Web de Alto Rendimiento: Resultados Comprobados",
  "description": "Análisis de métricas de conversión y rendimiento web utilizando arquitecturas modernas.",
  "author": { "@type": "Organization", "name": "Tu Máquina de Ventas" }
};
---

<Layout title="Tecnología y Resultados | Tu Máquina de Ventas">
  <script type="application/ld+json" set:html={JSON.stringify(schemaData)} />

  <main>
    <section class="relative pt-35 md:pt-50 pb-4 md:pb-20 overflow-hidden z-[500]" data-animate-section>

      <div class="container mx-auto px-6">
        <div class="max-w-4xl">
          <span class="text-cyan-400 font-medium uppercase tracking-widest text-sm mb-4 block animate-on-scroll font-zalando" data-animation="fade-in-down">
            Tecnología
          </span>
          <h1 class="text-3xl md:text-7xl font-bold mb-6 text-white leading-tight animate-on-scroll font-zalando" data-animation="fade-in-up" data-delay="100">
            La Ciencia detrás de <span class="text-gradient">tus Resultados</span>
          </h1>
          <p class="text-sm md:text-xl text-gray-400 max-w-2xl animate-on-scroll font-zalando" data-animation="fade-in-up" data-delay="200">
            No solo prometemos resultados. Los garantizamos con métricas transparentes y tecnología de última generación diseñada para la web de 2026.
          </p>
        </div>
      </div>
    </section>

    <section class="relative py-7 md:py-20 z-[500] backdrop-blur-[5px]" data-animate-section aria-label="Métricas clave de rendimiento">
      <div class="container mx-auto px-6">
        <dl class="grid grid-cols-2 md:grid-cols-4 gap-6">
          {stats.map((stat, index) => (
            <div class="glass-card text-center animate-on-scroll" data-animation="scale-in-bounce" data-delay={100 * (index + 1)}>
              <dt class="text-2xl md:text-4xl font-bold text-gradient mb-2 font-zalando">{stat.value}</dt>
              <dd class="text-[10px] md:text-sm text-gray-500 font-zalando uppercase tracking-wider">{stat.label}</dd>
            </div>
          ))}
        </dl>
      </div>
    </section>

    <section class="relative py-8 md:py-32 border-t border-white/5 z-[500]" data-animate-section>
      <div class="absolute inset-0 pointer-events-none bg-radial-blue opacity-60" aria-hidden="true"></div>

      <div class="container mx-auto px-6">
        <div class="text-center mb-16">
          <span class="text-cyan-400 font-medium uppercase tracking-widest text-sm mb-4 block animate-on-scroll font-zalando" data-animation="fade-in-down">
            View Transitions
          </span>
          <h2 class="text-4xl md:text-5xl font-bold mb-6 text-white animate-on-scroll font-zalando" data-animation="fade-in-up" data-delay="100">
            Navegación que <span class="text-gradient">Fluye</span>
          </h2>
          <p class="text-gray-400 max-w-2xl mx-auto animate-on-scroll text-sm md:text-base font-zalando" data-animation="fade-in-up" data-delay="200">
            Eliminamos el "parpadeo" tradicional. Tu contenido fluye de manera cinematográfica, preservando el contexto y la atención del usuario.
          </p>
        </div>

        <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto z-[500]">
          <article class="glass-card relative overflow-hidden animate-on-scroll" data-animation="slide-in-left" data-delay="300">
            <div class="absolute top-4 left-4 rounded-full bg-red-500/20 border border-red-500/50 px-3 py-1 text-[10px] text-red-400 uppercase tracking-tighter">
              Web Tradicional
            </div>
            <div class="pt-12">
              <div class="aspect-video bg-white/5 rounded-lg flex items-center justify-center border border-white/10" aria-hidden="true">
                <div class="text-center">
                  <div class="h-8 w-8 border-2 border-gray-600 border-t-transparent rounded-full animate-spin mx-auto mb-2" />
                  <p class="text-[10px] text-gray-500">Cargando...</p>
                </div>
              </div>
              <p class="text-xs text-gray-500 mt-4 text-center">Pantalla en blanco y pérdida de atención.</p>
            </div>
          </article>

          <article class="glass-card-primary relative overflow-hidden animate-on-scroll z-[500]" data-animation="slide-in-right" data-delay="300">
            <div class="absolute top-4 left-4 rounded-full bg-cyan-500/20 border border-cyan-500/50 px-3 py-1 text-[10px] text-cyan-400 uppercase tracking-tighter">
              Nuestra Ingeniería
            </div>
            <div class="pt-12">
              <div class="aspect-video bg-gradient-to-br from-cyan-500/10 to-purple-500/10 rounded-lg flex items-center justify-center border border-cyan-500/20" aria-hidden="true">
                <div class="text-center">
                  <div class="flex items-center justify-center mb-2 text-cyan-400"><Tunder size="32"/></div>
                  <p class="text-[10px] text-cyan-400 font-bold uppercase">Transición Instantánea</p>
                </div>
              </div>
              <p class="text-xs text-gray-400 mt-4 text-center">Experiencia premium, contexto preservado.</p>
            </div>
          </article>
        </div>
      </div>
    </section>

    <section class="relative py-6 md:py-32 border-t border-white/5 z-[500] hover:backdrop-blur-[4px]" data-animate-section>
      <div class="container mx-auto px-6">
        <div class="text-center mb-16">
          <span class="text-cyan-400 font-medium uppercase tracking-widest text-sm mb-4 block animate-on-scroll font-zalando" data-animation="fade-in-down">
            Stack Tecnológico
          </span>
          <h2 class="text-4xl md:text-5xl font-bold mb-6 text-white animate-on-scroll font-zalando" data-animation="fade-in-up" data-delay="100">
            Las Mejores <span class="text-gradient">Herramientas</span>
          </h2>
        </div>

        <ul class="flex flex-wrap justify-center gap-4 max-w-3xl mx-auto list-none p-0 z-[500]">
          {technologies.map((tech, index) => (
            <li class="animate-on-scroll" data-animation="zoom-in" data-delay={index * 50}>
              <span class="tech-tag inline-block">{tech}</span>
            </li>
          ))}
        </ul>
      </div>
    </section>

    <section class="relative py-6 md:py-32 border-t border-white/5 z-[500]" data-animate-section aria-labelledby="cases-title">
      <div class="container mx-auto px-6">
        <div class="text-center mb-16">
          <span class="text-cyan-400 font-medium uppercase tracking-widest text-sm mb-4 block animate-on-scroll font-zalando" data-animation="fade-in-down">
            Casos de Éxito
          </span>
          <h2 id="cases-title" class="text-4xl md:text-5xl font-bold mb-6 text-white animate-on-scroll font-zalando" data-animation="fade-in-up" data-delay="100">
            Resultados <span class="text-gradient">Comprobados</span>
          </h2>
        </div>

        <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto z-[500]">
          {caseStudies.map((study, studyIdx) => (
            <article class="glass-card animate-on-scroll" data-animation="fade-in-up" data-delay={200 + (studyIdx * 200)}>
              <div class="flex items-center justify-between mb-6 animate-on-scroll" data-animation={studyIdx === 0 ? "slide-in-left" : "slide-in-right"} data-delay="300">
                <div>
                  <h3 class="text-xl font-bold text-white font-zalando">{study.client}</h3>
                  <p class="text-sm text-gray-500 font-zalando">{study.industry}</p>
                </div>
                <span class="text-cyan-400 animate-on-scroll" data-animation="rotate-in" data-delay="400">
                  <Stats size="37"/>
                </span>
              </div>

              <div class="space-y-4">
                {study.results.map((result, idx) => (
                  <div 
                    class="flex items-center justify-between animate-on-scroll" 
                    data-animation="fade-in-up" 
                    data-delay={400 + (idx * 100)}
                  >
                    <span class="text-sm text-gray-500 font-zalando">{result.metric}</span>
                    <div class="flex items-center gap-3 font-zalando">
                      <span class="text-sm text-red-400/50 line-through">{result.before}</span>
                      <span class="text-sm text-cyan-400 font-semibold">{result.after}</span>
                    </div>
                  </div>
                ))}
              </div>
            </article>
          ))}
        </div>
      </div>
    </section>

    <section class="relative py-20 z-[500]" data-animate-section>
      <div class="container mx-auto px-6 text-center">
        <div class="animate-on-scroll" data-animation="fade-in-up" data-delay="100">
          <h2 class="text-3xl md:text-4xl font-bold mb-8 text-white font-zalando">
            ¿Quieres estos resultados?
          </h2>
          <a href="/contact" target="_blank" class="btn-magnetic inline-flex animate-on-scroll" data-animation="scale-in-bounce" data-delay="300">
            <span>Hablemos de tu Proyecto</span>
          </a>
        </div>
      </div>
    </section>
  </main>
</Layout>

<style>
  .bg-radial-blue {
    background: radial-gradient(
      circle at center, 
      rgba(0, 70, 201, 0.1) 0%, 
      transparent 75%
    );
  }
  /* Base de visibilidad */
  .animate-on-scroll { opacity: 0; }
  .animate-on-scroll.is-visible { opacity: 1; }

  /* Estilos de Componentes */
  .tech-tag {
    border-radius: 9999px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    background-color: rgba(255, 255, 255, 0.05);
    padding: 0.5rem 1.25rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: white;
    cursor: default;
    transition: all 0.3s ease;
  }
  .tech-tag:hover {
    border-color: rgba(0, 255, 255, 0.5);
    background-color: rgba(0, 255, 255, 0.1);
    transform: translateY(-2px);
  }

  .glass-card, .glass-card-primary {
    background-color: rgba(255, 255, 255, 0.02);
    backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 1.5rem;
    padding: 2rem;
  }
  .glass-card-primary { border-color: rgba(0, 255, 255, 0.3); }

  .text-gradient {
    background: linear-gradient(to r, #00E5FF, #a855f7);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .btn-magnetic {
    display: inline-flex;
    padding: 1.2rem 2.5rem;
    border-radius: 9999px;
    background: linear-gradient(to right, #00E5FF, #a855f7);
    color: white;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    transition: all 0.3s ease;
    box-shadow: 0 10px 30px -10px rgba(0, 255, 255, 0.4);
  }
  .btn-magnetic:hover {
    box-shadow: 0 20px 40px -10px rgba(0, 255, 255, 0.6);
    transform: translateY(-3px) scale(1.05);
  }
</style>

<script>
  function initScrollAnimations() {
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -100px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const animatedElements = entry.target.querySelectorAll('.animate-on-scroll');
          
          animatedElements.forEach((el) => {
            const animationType = el.getAttribute('data-animation');
            const delay = el.getAttribute('data-delay') || '0';
            
            setTimeout(() => {
              el.classList.add(`animate-${animationType}`);
              el.classList.add('is-visible');
            }, parseInt(delay));
          });
          observer.unobserve(entry.target);
        }
      });
    }, observerOptions);

    document.querySelectorAll('[data-animate-section]').forEach(section => {
      observer.observe(section);
    });
  }

  document.addEventListener('DOMContentLoaded', initScrollAnimations);
  document.addEventListener('astro:page-load', initScrollAnimations);
</script>