---
// src/pages/plans/[id].astro
import WhatsApp from '../../components/Icons/WhatsApp.astro';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  const plans = [
    {
      id: 'impulse',
      name: 'Impulse',
      tagline: 'Tu Primer Paso',
      price: '$0', 
      period: '/ setup bonificado',
      maintenancePrice: '$20 USD',
      maintenanceLabel: 'Mantenimiento Mensual',
      description: 'Ideal para validar sin riesgo. No inviertas miles en algo que no probaste: por lo que te cuesta una cena al mes, tenés una infraestructura profesional manteniendo tu oferta en línea.',
      concept: 'Es un entorno de validación profesional. Nosotros invertimos en el desarrollo (Setup $0) y vos solo cubrís el costo operativo mensual para mantenerlo activo y rápido.',
      painPoints: [
        'Miedo a invertir capital fuerte en una idea sin validar.',
        'Pagar desarrollos caros que luego quedan abandonados.',
        'Perder ventas por no tener una forma profesional de mostrarte.'
      ],
      solutions: [
        'Modelo de "Riesgo Compartido": Setup bonificado al 100%.',
        'Costo operativo mínimo (precio de una cena) para empezar.',
        'Infraestructura técnica completa incluida en la mensualidad.'
      ],
      idealFor: 'Emprendedores, lanzamiento de nuevos servicios, probar si un producto se vende.',
      accentColor: '#00ffff',
      benefits: [
        { label: 'Inversión', value: 'Setup $0', desc: 'No pagás por el desarrollo, solo por mantenerlo funcionando.' },
        { label: 'Costo', value: '$20/mes', desc: 'Accesible. Menos de lo que gastás en una salida a comer.' },
        { label: 'Velocidad', value: 'Inmediata', desc: 'Tu oferta está online y vendiendo en tiempo récord.' },
        { label: 'Riesgo', value: 'Mínimo', desc: 'Si tu idea no funciona, no perdiste miles de dólares en desarrollo.' }
      ],
      modules: [
        { title: 'Página de Venta Única', desc: 'Una sola pantalla, sin distracciones. Como un vendedor que solo habla de lo importante para cerrar la venta.' },
        { title: 'Textos que Convencen', desc: 'Escribimos los títulos y descripciones usando psicología de venta para que el cliente quiera comprar.' },
        { title: 'Botón Directo a WhatsApp', desc: 'Sin formularios aburridos. El cliente hace clic y ya está hablando con vos. Cero fricción.' },
        { title: 'Carga Instantánea', desc: 'Usamos tecnología moderna para que la web vuele. Si es rápida, vendés más. Así de simple.' },
        { title: 'Aparecé en el Mapa', desc: 'Te creamos la ficha de Google para que la gente de tu zona te encuentre rápido.' }
      ],
      roadmap: [
        { phase: '01', title: 'La Idea', desc: 'Nos contás qué vendés y elegimos la mejor forma de decirlo.' },
        { phase: '02', title: 'El Armado', desc: 'Preparamos todo para que se vea increíble y funcione rápido.' },
        { phase: '03', title: 'A la Cancha', desc: 'La publicamos y queda lista para recibir mensajes. Solo pagás el mantenimiento.' }
      ]
    },
    {
      id: 'authority',
      name: 'Authority',
      tagline: 'Tu Oficina Digital',
      price: '$299 USD',
      period: ' / único',
      maintenancePrice: '$40 USD',
      maintenanceLabel: 'Mantenimiento Mensual',
      description: 'Para cuando ya tenés un negocio funcionando y querés que te tomen en serio. Hacemos que Google te ame y que tus clientes te vean como el líder de tu rubro.',
      concept: 'Es como tener la oficina más lujosa de la ciudad, abierta las 24 horas. Responde las dudas de tus clientes, muestra tu trabajo y genera confianza automática.',
      painPoints: [
        'Comparación constante por precio bajo.',
        'Dependencia total de publicidad paga (Ads).',
        'Atención al cliente repetitiva y manual.'
      ],
      solutions: [
        'Diseño Premium que justifica honorarios altos.',
        'Estrategia SEO para captar clientes gratis en Google.',
        'Automatización de respuestas y educación del cliente.'
      ],
      idealFor: 'Clínicas, abogados, arquitectos, agencias y negocios que venden servicios caros.',
      accentColor: '#a855f7',
      benefits: [
        { label: 'Prestigio', value: 'Imagen Premium', desc: 'Una web que justifica por qué cobrás lo que cobrás.' },
        { label: 'Google', value: 'Te Encuentran', desc: 'Preparamos todo para aparecer cuando la gente busca tu servicio.' },
        { label: 'Ventas', value: 'Automáticas', desc: 'La web explica y convence por vos, ahorrándote horas de reuniones.' },
        { label: 'Control', value: 'Es Tuya', desc: 'Podés subir noticias o artículos nuevos fácilmente cuando quieras.' }
      ],
      modules: [
        { title: 'Sitio Web Completo', desc: 'Varias secciones (Quiénes somos, Servicios, Contacto) para mostrar la estructura real de tu negocio.' },
        { title: 'Blog de Novedades', desc: 'Un espacio para que escribas artículos. Esto le demuestra a Google (y a tus clientes) que sabés de lo que hablás.' },
        { title: 'Traductor para Google', desc: 'Configuramos la web internamente para que Google entienda exactamente qué hacés y te recomiende.' },
        { title: 'Formularios Inteligentes', desc: 'Preguntamos lo necesario antes de que te contacten, así solo hablás con clientes interesados de verdad.' },
        { title: 'Seguimiento de Visitas', desc: 'Instalamos "cámaras" digitales para saber cuánta gente entra y qué miran.' }
      ],
      roadmap: [
        { phase: '01', title: 'Estrategia', desc: 'Miramos qué hace tu competencia para hacer que vos te veas mejor.' },
        { phase: '02', title: 'Diseño', desc: 'Creamos una estructura visual que inspire confianza y calidad.' },
        { phase: '03', title: 'Lanzamiento', desc: 'La subimos a internet y le avisamos a Google que existís.' }
      ]
    },
    {
      id: 'titan',
      name: 'Titan',
      tagline: 'Tu Propia Fábrica',
      price: '$1200 USD',
      period: ' / inversión base',
      maintenancePrice: 'A Medida',
      maintenanceLabel: 'Soporte e Infraestructura',
      description: 'Cuando las herramientas normales te quedan chicas. Creamos un sistema a medida para tu empresa que hace el trabajo pesado, organiza tus datos y automatiza tareas.',
      concept: 'Dejás de alquilar software y pasás a ser dueño de tu propia tecnología. Es construir una máquina que trabaja exactamente como vos querés, sin límites.',
      painPoints: [
        'Desorden administrativo y datos en Excels sueltos.',
        'Costos elevados en suscripciones de software (SaaS).',
        'Tareas manuales que frenan la escalabilidad.'
      ],
      solutions: [
        'Centralización de datos en sistema propio.',
        'Propiedad total del código (Activo de empresa).',
        'Automatización de procesos a medida.'
      ],
      idealFor: 'Empresas grandes, startups, e-commerce especiales y negocios con procesos complejos.',
      accentColor: '#eab308',
      benefits: [
        { label: 'Propiedad', value: 'Es Tuyo', desc: 'El sistema es un activo de tu empresa. Sin pagos mensuales por usuario.' },
        { label: 'Orden', value: 'Todo Centralizado', desc: 'Clientes, ventas y procesos en un solo lugar, accesible desde cualquier lado.' },
        { label: 'Ahorro', value: 'Automatización', desc: 'El sistema hace en segundos lo que a un empleado le lleva horas.' },
        { label: 'Seguridad', value: 'Blindado', desc: 'Tus datos están protegidos con los estándares más altos.' }
      ],
      modules: [
        { title: 'Sistema a Medida', desc: 'Programamos el software desde cero para que haga exactamente lo que tu negocio necesita, ni más ni menos.' },
        { title: 'Base de Datos Propia', desc: 'Un archivo digital infinito y ultra rápido para guardar todos tus clientes, pedidos e historial.' },
        { title: 'Panel de Control (Dashboard)', desc: 'Una pantalla donde ves los números de tu negocio en tiempo real (ventas, usuarios, alertas).' },
        { title: 'Cuentas de Usuario', desc: 'Creas accesos para tus empleados, cada uno con permisos para ver solo lo que corresponde.' },
        { title: 'Conexión con Inteligencia Artificial', desc: 'Podemos conectar el sistema a IAs para que redacten correos o analicen datos por vos.' }
      ],
      roadmap: [
        { phase: '01', title: 'El Plano', desc: 'Nos sentamos a entender tu negocio y dibujamos cómo va a funcionar el sistema.' },
        { phase: '02', title: 'La Construcción', desc: 'Programamos el sistema por partes y te lo vamos mostrando para que lo apruebes.' },
        { phase: '03', title: 'La Entrega', desc: 'Lo instalamos, lo probamos a fondo y te enseñamos a usarlo.' }
      ]
    }
  ];

  return plans.map(plan => ({
    params: { id: plan.id },
    props: { plan }
  }));
}

const { plan } = Astro.props;
const WHATSAPP_NUMBER = "5491140230671";
const waMessage = encodeURIComponent(
  `Hola, me interesa el plan ${plan.name}. Entiendo los costos de inversión (${plan.price}) y mantenimiento (${plan.maintenancePrice}). ¿Podemos avanzar?`
);

const hexToRgb = (hex: string) => {
  const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
  return result
    ? `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}`
    : '255, 255, 255';
};

const rgbAccent = hexToRgb(plan.accentColor);
---

<Layout title={`Spec: ${plan.name} | Ingeniería Digital`}>
  
  <section class=" min-h-screen pb-40 font-sans text-gray-300" style={`--accent-rgb:${rgbAccent}; --accent:${plan.accentColor};`}>
    
    {/* NAVBAR SIMPLIFICADA */}
    <nav class="fixed top-0 left-0 w-full z-50 px-4 py-4 pointer-events-none animate-entry" style="transition-delay: 50ms;">
      <div class="max-w-7xl mx-auto flex justify-between items-center">
        <a href="/plans" class="pointer-events-auto bg-[#0a0a0f]/90 backdrop-blur border border-white/10 p-3 text-white hover:border-[var(--accent)] transition-all active:scale-95 group">
          {/* Icono de flecha "Corner" estilo técnico */}
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="group-hover:-translate-x-1 transition-transform"><path d="M19 12H5"/><path d="M12 19l-7-7 7-7"/></svg>
        </a>
        <div class="pointer-events-auto px-4 py-1 bg-[#0a0a0f]/90 backdrop-blur border-l-2 border-[var(--accent)] text-[10px] font-mono uppercase tracking-widest text-white/80">
          SYS.ID: {plan.id.toUpperCase()}
        </div>
      </div>
    </nav>

    {/* MAIN CONTENT WRAPPER */}
    <div class="relative z-10 container mx-auto px-5 pt-32 max-w-7xl">
      
      {/* --- HERO SECTION: BLUEPRINT STYLE --- */}
      <div class="grid lg:grid-cols-2 gap-12 lg:gap-24 mb-24 border-b border-white/5 pb-16">
        <div class="animate-entry" style="transition-delay: 100ms;">
          <div class="flex items-center gap-3 mb-6">
            <span class="w-2 h-2 bg-[var(--accent)]"></span>
            <span class="font-mono text-xs text-[var(--accent)] uppercase tracking-[0.2em]">{plan.tagline}</span>
          </div>
          
          <h1 class="text-6xl md:text-8xl font-bold text-white tracking-tighter mb-8 leading-[0.9] font-zalando" style={`color:${plan.accentColor}`}>
            {plan.name.toUpperCase()}
          </h1>
          
          <div class="relative pl-6 border-l border-white/10">
            <p class="text-xl md:text-2xl text-gray-200 font-light leading-snug mb-6">
              {plan.description}
            </p>
            <div class="text-xs font-mono text-gray-500 uppercase tracking-wide">
              // {plan.idealFor}
            </div>
          </div>
        </div>

        <div class="relative animate-entry" style="transition-delay: 200ms;">
          {/* Concept Box - Estilo HUD */}
          <div class="bg-[#08080a] border border-white/10 p-8 relative">
            {/* Esquinas Técnicas */}
            <div class="absolute top-0 left-0 w-2 h-2 border-t-2 border-l-2 border-[var(--accent)]"></div>
            <div class="absolute top-0 right-0 w-2 h-2 border-t-2 border-r-2 border-[var(--accent)]"></div>
            <div class="absolute bottom-0 left-0 w-2 h-2 border-b-2 border-l-2 border-[var(--accent)]"></div>
            <div class="absolute bottom-0 right-0 w-2 h-2 border-b-2 border-r-2 border-[var(--accent)]"></div>

            <h3 class="text-xs font-bold text-white/50 uppercase tracking-widest mb-4 border-b border-white/5 pb-2">Concepto de Arquitectura</h3>
            <p class="text-lg text-gray-300 italic font-medium leading-relaxed">
              "{plan.concept}"
            </p>
          </div>
        </div>
      </div>

      {/* --- DIAGNOSTIC VS SOLUTION (SPLIT VIEW) --- */}
      <div class="mb-24 animate-entry" style="transition-delay: 300ms;">
        <h2 class="font-mono text-xs text-gray-500 mb-8 uppercase tracking-widest flex items-center gap-4">
          <span>01. Diagnóstico del sistema</span>
          <span class="h-px bg-white/10 flex-1"></span>
        </h2>

        <div class="grid md:grid-cols-2 gap-px bg-white/5 border border-white/10 overflow-hidden">
          
          {/* Columna Izquierda: Problemas */}
          <div class="bg-[#050505] p-8 relative group">
            <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
              <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="red" stroke-width="1"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
            </div>
            <h3 class="text-red-500 font-mono text-sm font-bold mb-6">[DETECTED_ERRORS]</h3>
            <ul class="space-y-6">
              {plan.painPoints.map(p => (
                <li class="flex gap-4 items-start">
                  <span class="text-red-500/50 mt-1">x</span>
                  <span class="text-gray-400">{p}</span>
                </li>
              ))}
            </ul>
          </div>

          {/* Columna Derecha: Soluciones */}
          <div class="bg-[#08080a] p-8 relative group">
             <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
              <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="text-[var(--accent)]" stroke-width="1"><polyline points="20 6 9 17 4 12"/></svg>
            </div>
            <h3 class="text-[var(--accent)] font-mono text-sm font-bold mb-6">[APPLIED_PATCHES]</h3>
            <ul class="space-y-6">
              {plan.solutions.map(s => (
                <li class="flex gap-4 items-start">
                  <span class="text-[var(--accent)] mt-1">✓</span>
                  <span class="text-white">{s}</span>
                </li>
              ))}
            </ul>
          </div>
        </div>
      </div>

      {/* --- SPECS & METRICS (BENTO GRID) --- */}
      <div class="mb-24">
        <h2 class="font-mono text-xs text-gray-500 mb-8 uppercase tracking-widest flex items-center gap-4 animate-entry" style="transition-delay: 400ms;">
          <span>02. Especificaciones</span>
          <span class="h-px bg-white/10 flex-1"></span>
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          
          {/* Metrics Cards */}
          {plan.benefits.map((b, i) => (
            <div class="bg-[#0a0a0f] border border-white/10 p-6 flex flex-col justify-between h-full hover:border-[var(--accent)] transition-colors duration-300 animate-entry backdrop-blur-[5px]" style={`transition-delay: ${400 + (i * 100)}ms;`}>
              <div>
                <span class="font-mono text-[10px] text-gray-500 uppercase block mb-3 border-b border-white/5 pb-2">{b.label}</span>
                <span class="text-2xl font-bold text-white block mb-2">{b.value}</span>
              </div>
              <p class="text-xs text-gray-400 leading-relaxed">{b.desc}</p>
            </div>
          ))}

          {/* Module List (Spans full width on mobile, 2 cols on LG) */}
          <div class="md:col-span-2 lg:col-span-4 bg-white/[0.02] border border-white/10 p-8 mt-4 animate-entry" style="transition-delay: 800ms;">
            <div class="grid md:grid-cols-2 gap-8">
              {plan.modules.map(m => (
                <div class="flex gap-4">
                  <div class="w-1 h-full bg-[var(--accent)]/20 flex flex-col justify-center items-center">
                    <div class="w-1 h-1 bg-[var(--accent)]"></div>
                  </div>
                  <div>
                    <h4 class="text-white font-bold text-sm mb-1">{m.title}</h4>
                    <p class="text-xs text-gray-400">{m.desc}</p>
                  </div>
                </div>
              ))}
            </div>
          </div>

        </div>
      </div>

      {/* --- TIMELINE (VERTICAL FLOW) --- */}
      <div class="mb-20">
        <h2 class="font-mono text-xs text-gray-500 mb-8 uppercase tracking-widest flex items-center gap-4 animate-entry" style="transition-delay: 900ms;">
          <span>03. Plan de ejecución</span>
          <span class="h-px bg-white/10 flex-1"></span>
        </h2>

        <div class="space-y-0">
          {plan.roadmap.map((step, i) => (
            <div class="flex group animate-entry" style={`transition-delay: ${1000 + (i * 100)}ms;`}>
              <div class="w-20 md:w-32 py-8 border-r border-white/10 font-mono text-[10px] text-gray-500 text-right pr-6 pt-9">
                {step.phase}
              </div>
              <div class="flex-1 py-8 border-b border-white/5 pl-6 md:pl-10 relative">
                {/* Dot on timeline */}
                <div class="absolute left-[-5px] top-10 w-2.5 h-2.5 bg-[#050505] border border-gray-600 group-hover:border-[var(--accent)] transition-colors z-10"></div>
                
                <h3 class="text-white text-lg font-bold mb-2 group-hover:text-[var(--accent)] transition-colors">{step.title}</h3>
                <p class="text-sm text-gray-400 max-w-xl">{step.desc}</p>
              </div>
            </div>
          ))}
        </div>
      </div>

    </div>

    {/* --- STICKY ACTION BAR (ENGINEERING STYLE) --- */}
    <div class="fixed bottom-0 left-0 right-0 z-50 animate-entry" style="transition-delay: 1200ms;">
      
      {/* Barra de estado decorativa superior */}
      <div class="h-1 w-full bg-gradient-to-r from-transparent via-[var(--accent)] to-transparent opacity-50"></div>
      
      <div class="bg-[#08080a] border-t border-white/10 p-4 md:p-6 backdrop-blur-xl">
        <div class="max-w-7xl mx-auto flex flex-col md:flex-row items-center justify-between gap-4">
          
          <div class="flex items-center gap-6 w-full md:w-auto justify-between md:justify-start">
            
            {/* Precio Principal */}
            <div>
              <span class="block text-[9px] font-mono text-gray-500 uppercase tracking-wider mb-1">Inversión Inicial</span>
              <div class="flex items-baseline gap-2">
                <span class="text-2xl font-bold text-white font-zalando">{plan.price}</span>
                <span class="text-xs text-gray-400">{plan.period}</span>
              </div>
            </div>

            {/* Separador Vertical */}
            <div class="w-px h-8 bg-white/10 hidden md:block"></div>

            {/* Costo de Mantenimiento (Highlight) */}
            <div class="bg-white/[0.03] px-3 py-2 border border-white/5 rounded-md">
              <span class="block text-[8px] font-mono text-[var(--accent)] uppercase tracking-wider mb-0.5 opacity-80">Costo Operativo</span>
              <div class="flex items-baseline gap-1">
                <span class="text-sm font-bold text-white">+ {plan.maintenancePrice}</span>
                <span class="text-[9px] text-gray-500">/ mes</span>
              </div>
            </div>
          </div>

          {/* Botón de Acción */}
          <a
            href={`https://wa.me/${WHATSAPP_NUMBER}?text=${waMessage}`}
            target="_blank"
            class="w-full md:w-auto group relative overflow-hidden bg-white text-black px-8 py-3 font-bold text-sm tracking-wide uppercase hover:bg-[var(--accent)] transition-colors duration-300 flex items-center justify-center gap-3 clip-path-slant"
          >
            <span>Iniciar Protocolo</span>
            <WhatsApp class="w-4 h-4" />
          </a>

        </div>
      </div>
    </div>

  </section>
</Layout>

<style>
  .font-zalando {
    font-family: system-ui, -apple-system, sans-serif;
  }
  
  .page-container {
    background-color: #050505;
  }

  /* Clip path para el botón con corte técnico */
  .clip-path-slant {
    clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
  }

  /* Animaciones de Entrada */
  .animate-entry {
    opacity: 0;
    transform: translateY(15px);
    transition: opacity 0.8s cubic-bezier(0.16, 1, 0.3, 1), transform 0.8s cubic-bezier(0.16, 1, 0.3, 1);
    will-change: opacity, transform;
  }
  
  .animate-entry.is-visible {
    opacity: 1;
    transform: translateY(0);
  }
</style>

<script>
    function initScrollAnimations() {
        const elements = document.querySelectorAll('.animate-entry');
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                    observer.unobserve(entry.target); // Solo animar una vez
                }
            });
        }, { threshold: 0.05, rootMargin: "0px 0px -50px 0px" });

        elements.forEach(el => observer.observe(el));
    }

    document.addEventListener('DOMContentLoaded', initScrollAnimations);
    document.addEventListener('astro:page-load', initScrollAnimations);
</script>